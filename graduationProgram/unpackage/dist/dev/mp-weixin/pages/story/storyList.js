(global.webpackJsonp=global.webpackJsonp||[]).push([["pages/story/storyList"],{100:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!./node_modules/css-loader??ref--6-oneOf-1-2!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src??ref--6-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=style&index=0&lang=css& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,i){},93:
/*!**************************************************************************************************!*\
  !*** C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/main.js?{"page":"pages%2Fstory%2FstoryList"} ***!
  \**************************************************************************************************/
/*! no static exports found */function(t,e,i){"use strict";(function(t){i(/*! uni-pages */4);e(i(/*! vue */2));function e(t){return t&&t.__esModule?t:{default:t}}t(e(i(/*! ./pages/story/storyList.vue */94)).default)}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).createPage)},94:
/*!*******************************************************************************!*\
  !*** C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue ***!
  \*******************************************************************************/
/*! no static exports found */function(t,e,i){"use strict";i.r(e);var n=i(/*! ./storyList.vue?vue&type=template&id=21e56e6c& */95),o=i(/*! ./storyList.vue?vue&type=script&lang=js& */97);for(var s in o)"default"!==s&&function(t){i.d(e,t,function(){return o[t]})}(s);i(/*! ./storyList.vue?vue&type=style&index=0&lang=css& */99);var a=i(/*! ../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */10),r=Object(a.default)(o.default,n.render,n.staticRenderFns,!1,null,null,null,!1,n.components,void 0);r.options.__file="7月4号丘/graduationProgram/pages/story/storyList.vue",e.default=r.exports},95:
/*!**************************************************************************************************************!*\
  !*** C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=template&id=21e56e6c& ***!
  \**************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,i){"use strict";i.r(e);var n=i(/*! -!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./storyList.vue?vue&type=template&id=21e56e6c& */96);i.d(e,"render",function(){return n.render}),i.d(e,"staticRenderFns",function(){return n.staticRenderFns}),i.d(e,"recyclableRender",function(){return n.recyclableRender}),i.d(e,"components",function(){return n.components})},96:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=template&id=21e56e6c& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,i){"use strict";i.r(e),i.d(e,"render",function(){return o}),i.d(e,"staticRenderFns",function(){return a}),i.d(e,"recyclableRender",function(){return s}),i.d(e,"components",function(){return n});var n={"u-icon":()=>i.e(/*! import() | uview-ui/components/u-icon/u-icon */"uview-ui/components/u-icon/u-icon").then(i.bind(null,/*! @/uview-ui/components/u-icon/u-icon.vue */210))},o=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.storyList,function(e,i){var n=e.storyContent.substring(0,20);return{$orig:t.__get_orig(e),g0:n}}));t.$mp.data=Object.assign({},{$root:{l0:i}})},s=!1,a=[];o._withStripped=!0},97:
/*!********************************************************************************************************!*\
  !*** C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************/
/*! no static exports found */function(t,e,i){"use strict";i.r(e);var n=i(/*! -!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./storyList.vue?vue&type=script&lang=js& */98),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e.default=o.a},98:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,o=(n=i(/*! ../../api/story/api.js */67))&&n.__esModule?n:{default:n};var s={data:function(){return{fix:!1,refreshAsync:!1,placeName:"",placeData:1,storyList:[],page_id:1,currLength:0,loadingText:"加载中...",loadingType:0,contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多了哦"},mark_icon:"../../static/story/icon/mark.png",mark_after_icon:"../../static/story/icon/mark_after.png",like_icon:"../../static/story/icon/like.png",like_after_icon:"../../static/story/icon/like_after.png"}},methods:{_previewImage:function(e,i){this.refreshAsync=!0;var n=this.storyList[e].imgList;t.previewImage({urls:n,current:n[i]})},toViewMore:function(e){t.navigateTo({url:"storyDetails?sid=".concat(this.storyList[e].sid)})},toPostStory:function(){console.log("to post new one!"),t.switchTab({url:"/pages/story/postStory"})},getmorenews:function(){var e=this;if(0!==this.loadingType)return!1;this.loadingType=1,t.showNavigationBarLoading();var i=this;o.default.getStory({location_id:this.placeData,page_id:this.page_id}).then(function(n){console.log("res",n),0!=n.data.storyList.length?function(){console.log("storyList",n);for(var t=JSON.parse(JSON.stringify(n.data.storyList)),s=function(i){o.default.getComments({sid:t[i].sid,page_id:1}).then(function(n){for(var o=JSON.parse(JSON.stringify(n.data.discussList)),s=[],a=0;a<o.length;a++)s.push({did:o[a].did,headPic:o[a].avatar,name:o[a].username,content:o[a].detail,like_num:o[a].count,like_flag:o[a].goodFlag});t[i].tempCommentList=s,e.storyList.push({sid:t[i].sid,usrname:t[i].username,avatar:t[i].avatar,time:t[i].pubDate,tags:t[i].tagsList,storyContent:t[i].detail,imgList:t[i].showImgList,comment_num:t[i].discussCount,mark_flag:t[i].collectFlag,like_flag:t[i].goodFlag,like_num:t[i].goodCount,commentList:t[i].tempCommentList})})},a=0;a<t.length;a++)s(a);i.page_id++,i.currLength=e.storyList.length,i.loadingType=0}():n.data?(i.loadingType=2,i.page_id--,console.log("botton page",e.page_id),t.showToast({icon:"none",title:"没有更多了哦！"})):t.showToast({icon:"loading",title:"获取数据失败"})}).catch(function(t){console.log(t)});var n={place:this.placeData,listInfo:this.storyList};this.$store.commit("updateStoryList",n),console.log("update",this.$store.state.storyList)},reply:function(t){this.fix=!0,this.$refs["comment_pop".concat(t)][0].reply()},fixBackground:function(){this.fix=!1},updateCommentList:function(t){var e=this;console.log("data:",t),this.storyList[t].comment_num++;var i=parseInt(this.storyList[t].comment_num/8+1),n=this.storyList[t].comment_num%8;0==n?(i--,n=7):n--,console.log(i),o.default.getComments({sid:this.storyList[t].sid,page_id:i}).then(function(i){console.log("uupdate",i);var o=JSON.parse(JSON.stringify(i.data.discussList));e.storyList[t].commentList.push({did:o[n].did,headPic:o[n].avatar,name:o[n].username,content:o[n].detail,like_num:o[n].count,like_flag:o[n].goodFlag})})},mark:function(t){this.storyList[t].mark_flag=!this.storyList[t].mark_flag,1==this.storyList[t].mark_flag?o.default.postMarkStory({sid:this.storyList[t].sid}).then(function(t){console.log("postMarkStory",t)}):o.default.postCancelMarkStory({sid:this.storyList[t].sid}).then(function(t){console.log("postCancelMarkStory",t)})},like:function(t){this.storyList[t].like_flag=!this.storyList[t].like_flag,1==this.storyList[t].like_flag?(this.storyList[t].like_num++,o.default.postLikeStory({sid:this.storyList[t].sid}).then(function(t){console.log("postLikeStory",t.data)})):(this.storyList[t].like_num--,o.default.postCancelLikeStory({sid:this.storyList[t].sid}).then(function(t){console.log("postCancelLikeStory",t.data)}))}},onLoad:function(t){this.placeData=t.aid,this.placeName=t.place,console.log("placeData",this.placeData,"this.placeName",this.placeName);var e={place:this.placeData,listInfo:[]};this.$store.commit("initializeStoryList",e)},onShow:function(){var t=this;if(this.refreshAsync)this.refreshAsync=!1;else{var e={place:this.placeData,listInfo:[]};this.$store.commit("initializeStoryList",e),this.storyList=[],this.page_id=1,o.default.getStory({location_id:this.placeData,page_id:this.page_id}).then(function(e){console.log("storyList",e);for(var i=JSON.parse(JSON.stringify(e.data.storyList)),n=function(e){var n=parseInt(i[e].discussCount/8+1),s=i[e].discussCount%8;0==s?0!=i[e].discussCount&&(n--,s=7):s--,o.default.getComments({sid:i[e].sid,page_id:n}).then(function(n){for(var o=JSON.parse(JSON.stringify(n.data.discussList)),s=[],a=0;a<o.length;a++)s.push({did:o[a].did,headPic:o[a].avatar,name:o[a].username,content:o[a].detail,like_num:o[a].count,like_flag:o[a].goodFlag});i[e].tempCommentList=s,t.storyList.push({sid:i[e].sid,usrname:i[e].username,avatar:i[e].avatar,time:i[e].pubDate,tags:i[e].tagsList,storyContent:i[e].detail,imgList:i[e].showImgList,comment_num:i[e].discussCount,mark_flag:i[e].collectFlag,like_flag:i[e].goodFlag,like_num:i[e].goodCount,commentList:i[e].tempCommentList})})},s=0;s<i.length;s++)n(s)}),this.page_id++;var i={place:this.placeData,listInfo:this.storyList};this.$store.commit("updateStoryList",i)}},onReachBottom:function(){this.getmorenews()},components:{uniLoadMore:function(){return i.e(/*! import() | pages/components/uni-load-more */"pages/components/uni-load-more").then(i.bind(null,/*! ../components/uni-load-more.vue */84))},commentPop:function(){return i.e(/*! import() | pages/story/comment_pop_component */"pages/story/comment_pop_component").then(i.bind(null,/*! ../story/comment_pop_component */217))}}};e.default=s}).call(this,i(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1).default)},99:
/*!****************************************************************************************************************!*\
  !*** C:/Users/Ivan/Desktop/7月4号丘/graduationProgram/pages/story/storyList.vue?vue&type=style&index=0&lang=css& ***!
  \****************************************************************************************************************/
/*! no static exports found */function(t,e,i){"use strict";i.r(e);var n=i(/*! -!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--6-oneOf-1-1!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/css-loader??ref--6-oneOf-1-2!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src??ref--6-oneOf-1-3!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../HBuilderX.2.6.1.20200226.full/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./storyList.vue?vue&type=style&index=0&lang=css& */100),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e.default=o.a}},[[93,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/story/storyList.js.map